(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},n={app:0},s=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},cd49:function(t,e,a){"use strict";a.r(e);a("4160"),a("159b"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"iconbox"},[a("svg",{staticClass:"bi",attrs:{width:t.size,height:t.size,fill:"currentColor"}},[a("use",{attrs:{"xlink:href":t.iconHref()}})]),t._v(" "+t._s(t.text)+" ")])},s=[],r=a("d4ec"),o=a("bee2"),l=a("262e"),c=a("2caf"),u=a("9ab4"),d=a("60a3"),p=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"iconHref",value:function(){return"/static/bootstrap-icons.svg#".concat(this.icon)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],p.prototype,"icon",void 0),Object(u["a"])([Object(d["b"])()],p.prototype,"size",void 0),Object(u["a"])([Object(d["b"])()],p.prototype,"text",void 0),p=Object(u["a"])([d["a"]],p);var h=p,v=h,m=a("2877"),g=Object(m["a"])(v,n,s,!1,null,null,null),f=g.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.successMessage.length>0?a("div",{staticClass:"alert alert-success"},[t._v(t._s(t.successMessage))]):t._e(),t.warningMessage.length>0?a("div",{staticClass:"alert alert-warning"},[t._v(t._s(t.warningMessage))]):t._e(),t.errorMessage.length>0?a("div",{staticClass:"alert alert-danger"},[t._v(t._s(t.errorMessage))]):t._e()])},y=[],_=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.successMessage="",t.warningMessage="",t.errorMessage="",t.successFlashTimeout=null,t.warningFlashTimeout=null,t}return Object(o["a"])(a,[{key:"clearMessages",value:function(){this.successMessage="",this.warningMessage="",this.errorMessage="",null!==this.successFlashTimeout&&clearTimeout(this.successFlashTimeout),null!==this.warningFlashTimeout&&clearTimeout(this.warningFlashTimeout),this.successFlashTimeout=null,this.warningFlashTimeout=null}},{key:"setSuccessFlash",value:function(t){var e=this;this.successMessage=t,this.successFlashTimeout=setTimeout((function(){e.successMessage="",e.successFlashTimeout=null}),5e3)}},{key:"setWarningFlash",value:function(t){var e=this;this.warningMessage=t,this.warningFlashTimeout=setTimeout((function(){e.warningMessage="",e.warningFlashTimeout=null}),5e3)}},{key:"setError",value:function(t){this.errorMessage=t}},{key:"appendError",value:function(t){this.errorMessage+=t}}]),a}(d["c"]);_=Object(u["a"])([d["a"]],_);var x=_,w=x,O=Object(m["a"])(w,b,y,!1,null,"5aed2331",null),k=O.exports,j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{class:t.className,attrs:{type:"button",id:t.id,"data-toggle":"modal","data-target":"#"+t.modalId}},[t._t("default")],2)},E=[],S=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return a}(d["c"]);Object(u["a"])([Object(d["b"])()],S.prototype,"className",void 0),Object(u["a"])([Object(d["b"])()],S.prototype,"id",void 0),Object(u["a"])([Object(d["b"])()],S.prototype,"modalId",void 0),S=Object(u["a"])([d["a"]],S);var C=S,T=C,I=Object(m["a"])(T,j,E,!1,null,"439e458a",null),P=I.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal fade",attrs:{id:t.modalId,tabindex:"-1",role:"dialog","aria-labelledby":t.modalId+"Label","aria-hidden":"true"}},[a("div",{class:"modal-dialog "+t.sizeClass,attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:t.modalId+"Label"}},[t._v(t._s(t.title))]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":t.getText("Close")}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),a("div",{staticClass:"modal-body"},[t._t("default")],2),t.showFooter?a("div",{staticClass:"modal-footer"},[t._t("footer",[a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.handleAccept()}}},[t._v(t._s(t.getText("OK")))]),a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(t._s(t.getText("Cancel")))])])],2):t._e()])])])},A=[],M=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"closeButtonText",value:function(){return gettext("Close")}},{key:"handleAccept",value:function(){this.$emit("modalAccept",this.modalId)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],M.prototype,"modalId",void 0),Object(u["a"])([Object(d["b"])()],M.prototype,"title",void 0),Object(u["a"])([Object(d["b"])({default:""})],M.prototype,"sizeClass",void 0),Object(u["a"])([Object(d["b"])({default:!0})],M.prototype,"showFooter",void 0),M=Object(u["a"])([d["a"]],M);var F=M,D=F,R=Object(m["a"])(D,L,A,!1,null,null,null),N=R.exports,z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return this.maxPages>1?a("nav",{staticClass:"ms-pagination",attrs:{"aria-label":t.getText("Page navigation")}},[a("ul",{staticClass:"pagination"},[a("li",{staticClass:"page-item"},[a("button",{staticClass:"page-link",attrs:{type:"button","aria-label":t.getText("Previous"),disabled:!t.canGoBack()},on:{click:function(e){return t.$emit("back")}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")]),a("span",{staticClass:"sr-only"},[t._v(t._s(t.getText("Previous")))])])]),a("li",{staticClass:"page-item"},[a("span",{staticClass:"page-link"},[t._v(t._s(this.currentPage)+"/"+t._s(this.maxPages))])]),a("li",{staticClass:"page-item"},[a("button",{staticClass:"page-link",attrs:{type:"button","aria-label":t.getText("Next"),disabled:!t.canGoForward()},on:{click:function(e){return t.$emit("forward")}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")]),a("span",{staticClass:"sr-only"},[t._v(t._s(t.getText("Next")))])])])])]):t._e()},B=[],U=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"canGoBack",value:function(){return this.currentPage>1}},{key:"canGoForward",value:function(){return this.currentPage<this.maxPages}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],U.prototype,"currentPage",void 0),Object(u["a"])([Object(d["b"])()],U.prototype,"maxPages",void 0),U=Object(u["a"])([d["a"]],U);var H=U,W=H,G=Object(m["a"])(W,z,B,!1,null,null,null),q=G.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"btn btn-sm btn-danger",attrs:{type:"button"},on:{click:function(e){return t.$emit("delete",t.item)}}},[a("IconBox",{attrs:{icon:"trash",size:"12",text:t.theText()}})],1)},X=[],K=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"theText",value:function(){return gettext("Delete")}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],K.prototype,"item",void 0),K=Object(u["a"])([d["a"]],K);var Q=K,Y=Q,J=Object(m["a"])(Y,V,X,!1,null,null,null),Z=J.exports,tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{domProps:{innerHTML:t._s(t.getValidityText())}})},et=[],at=(a("ac1f"),a("5319"),a("5a0c")),it=a.n(at),nt="YYYY-MM-DD HH:mm:ss",st=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"startedDate",value:function(){return"string"===typeof this.started?it()(this.started):this.started}},{key:"endedDate",value:function(){return"string"===typeof this.ended?it()(this.ended):this.ended}},{key:"getValidityText",value:function(){var t=this.startedDate(),e=this.endedDate();if(null==t&&null==e)return gettext("indefinitely");var a="";return null!=t&&(a+=gettext("from {date}").replace("{date}",t.format(nt))),null!=t&&null!=e&&(a+="<br>"),null!=e&&(a+=gettext("until {date}").replace("{date}",e.format(nt))),a}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],st.prototype,"started",void 0),Object(u["a"])([Object(d["b"])()],st.prototype,"ended",void 0),st=Object(u["a"])([d["a"]],st);var rt=st,ot=rt,lt=Object(m["a"])(ot,tt,et,!1,null,null,null),ct=lt.exports,ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.showText(t.item.standardMetaField)?a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.value,expression:"item.value"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.getPlaceholder()},domProps:{value:t.item.value},on:{change:function(e){return t.item.updateText()},input:function(e){e.target.composing||t.$set(t.item,"value",e.target.value)}}})]):t._e(),t.showBool(t.item.standardMetaField)?a("div",[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.value,expression:"item.value"}],staticClass:"mr-1",attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.item.value,"1")},on:{change:[function(e){return t.$set(t.item,"value","1")},function(e){return t.item.updateText()}]}}),t._v(" "+t._s(t.getText("yes")))]),a("label",{staticClass:"ml-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.value,expression:"item.value"}],staticClass:"mr-1",attrs:{type:"radio",value:"0"},domProps:{checked:t._q(t.item.value,"0")},on:{change:[function(e){return t.$set(t.item,"value","0")},function(e){return t.item.updateText()}]}}),t._v(" "+t._s(t.getText("no")))])]):t._e(),t.showUnits(t.item.standardMetaField)?a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.item.value,expression:"item.value"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.getPlaceholder()},domProps:{value:t.item.value},on:{change:function(e){return t.item.updateText()},input:function(e){e.target.composing||t.$set(t.item,"value",e.target.value)}}}),a("select",{directives:[{name:"model",rawName:"v-model",value:t.item.units,expression:"item.units"}],staticClass:"form-control",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.item,"units",e.target.multiple?a:a[0])},function(e){return t.item.updateText()}]}},[a("option",{attrs:{value:""}},[t._v("---------")]),t._l(t.item.standardMetaField.expected_units_names,(function(e){return a("option",{key:e,domProps:{value:e}},[t._v(t._s(e)+" ")])}))],2)]):t._e()])},dt=[],pt=(a("b0c0"),a("99af"),a("d3b7"),a("2ca0"),a("96cf"),a("1da1")),ht=function t(e,a,i,n,s){Object(r["a"])(this,t),this.slug="",this.name="",this.value="",this.units="",this.text="",this.slug=e,this.name=a,this.value=i,this.units=n,this.text=s},vt=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return Object(r["a"])(this,a),t=e.call(this,i,n,s,o,l),t.id=0,t.standardMetaField=null,t.id=c,t.standardMetaField=u,t}return Object(o["a"])(a,[{key:"toGeneral",value:function(){var t=this.slug.startsWith("__")?"":this.slug;return new ht(t,this.name,this.value,this.units,this.text)}},{key:"updateText",value:function(){var t,e,a;"_str"===(null===(t=this.standardMetaField)||void 0===t?void 0:t.expected_units)||"_number"===(null===(e=this.standardMetaField)||void 0===e?void 0:e.expected_units)?this.text=this.value:"_bool"===(null===(a=this.standardMetaField)||void 0===a?void 0:a.expected_units)?this.text="1"===this.value?gettext("yes"):gettext("no"):""!==this.units?this.text="".concat(this.value," ").concat(this.units):this.text=this.value}}],[{key:"toInternal",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new a(t.slug,t.name,t.value,t.units,t.text,e,i)}}]),a}(ht),mt=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(r["a"])(this,t),this.items=[],this.subcategory=null,this.items=e,this.subcategory=a};function gt(t,e){return ft.apply(this,arguments)}function ft(){return ft=Object(pt["a"])(regeneratorRuntime.mark((function t(e,a){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e,null!==a&&(i+="".concat(a,"/")),t.next=4,fetch(i,{credentials:"same-origin"});case 4:return n=t.sent,t.abrupt("return",n.json());case 6:case"end":return t.stop()}}),t)}))),ft.apply(this,arguments)}var bt={TEXT:function(t,e){return"_number"===t||"_str"===t||"_user"===t&&0===e.length},BOOL:function(t){return"_bool"===t},SELECT_UNIT:function(t,e){return"_user"===t&&0!==e.length||null!==t&&!t.startsWith("_")}},yt=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"showText",value:function(t){return null===t||bt.TEXT(t.expected_units,t.expected_units_names)}},{key:"showBool",value:function(t){return null!==t&&bt.BOOL(t.expected_units)}},{key:"showUnits",value:function(t){return null!=t&&bt.SELECT_UNIT(t.expected_units,t.expected_units_names)}},{key:"getPlaceholder",value:function(){return"---------"===this.item.name?gettext("Select or type a property name…"):this.item.name}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],yt.prototype,"item",void 0),yt=Object(u["a"])([d["a"]],yt);var _t=yt,xt=_t,wt=Object(m["a"])(xt,ut,dt,!1,null,null,null),Ot=wt.exports,kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{class:{"table-info":t.change.hasValueChanges(),"table-warning":t.change.hasExtrasChanges()}},[a("td",[a("a",{attrs:{href:t.product.details_url,target:"_blank"}},[t._v(t._s(t.product.name))])]),a("td",[a("a",{attrs:{href:t.product.vendor_details_url,target:"_blank"}},[t._v(t._s(t.product.vendor))])]),a("td",[a("ValidityText",{attrs:{started:t.product.date_started,ended:t.product.date_ended}})],1),t.change.hasExtrasChanges()?t._e():a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.change.subaisle,expression:"change.subaisle"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.change,"subaisle",e.target.multiple?a:a[0])}}},[a("option",{domProps:{value:null}},[t._v("---------")]),t._l(t.aisleStructure,(function(e){return a("optgroup",{key:e.id,attrs:{label:e.name}},t._l(e.subaisles,(function(e){return a("option",{key:e.id,domProps:{value:e}},[t._v(t._s(e.name))])})),0)}))],2)]),t.change.hasExtrasChanges()?t._e():a("td",[a("div",{staticClass:"input-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.change.tile,expression:"change.tile"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.change,"tile",e.target.multiple?a:a[0])}}},[a("option",{domProps:{value:null}},[t._v("---------")]),t._l(t.tileList,(function(e){return a("option",{key:e.id,domProps:{value:e}},[t._v(t._s(e.letterCoordsWithText))])}))],2),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-sm",class:{"btn-outline-dark":!t.isPicking,"btn-dark":t.isPicking},staticStyle:{padding:"0"},attrs:{type:"button",title:t.getText("Pick from map")},on:{click:function(e){return t.startPicking()}}},[a("IconBox",{attrs:{size:12,text:"",icon:"cursor-fill"}})],1)])])]),t.change.hasExtrasChanges()?a("td",{attrs:{colspan:"2"}},[t.change.revert_auto?a("span",[t._v(t._s(t.getText("Location will revert to auto")))]):t._e(),t.change.delete_location?a("span",[t._v(t._s(t.getText("Location will be deleted")))]):t._e()]):t._e(),a("td",[t.change.hasChanges()?a("button",{staticClass:"btn btn-sm btn-warning mr-1",attrs:{type:"button"},on:{click:function(e){return t.undoChanges()}}},[a("IconBox",{attrs:{size:12,text:t.getText("Undo"),icon:"x-square"}})],1):t._e(),a("div",{staticClass:"dropdown d-inline-block"},[a("button",{staticClass:"btn btn-sm btn-secondary dropdown-toggle",attrs:{type:"button",id:"plt-extras-"+t.product.id,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[a("IconBox",{attrs:{size:12,text:t.getText("Special"),icon:"gear-fill"}})],1),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"plt-extras-"+t.product.id}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){return t.revertAuto()}}},[t._v(t._s(t.getText("Revert to auto location")))]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){return t.deleteLocation()}}},[t._v(t._s(t.getText("Delete location")))])])])])])},jt=[],Et=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){return Object(r["a"])(this,a),e.apply(this,arguments)}return Object(o["a"])(a,[{key:"undoChanges",value:function(){this.change.subaisle=this.change.start_subaisle,this.change.tile=this.change.start_tile,this.change.revert_auto=!1,this.change.delete_location=!1}},{key:"revertAuto",value:function(){this.undoChanges(),this.change.revert_auto=!0}},{key:"deleteLocation",value:function(){this.undoChanges(),this.change.delete_location=!0}},{key:"startPicking",value:function(){this.$emit("startPicking",this.change)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Et.prototype,"product",void 0),Object(u["a"])([Object(d["b"])()],Et.prototype,"change",void 0),Object(u["a"])([Object(d["b"])()],Et.prototype,"aisleStructure",void 0),Object(u["a"])([Object(d["b"])()],Et.prototype,"tileList",void 0),Object(u["a"])([Object(d["b"])()],Et.prototype,"isPicking",void 0),Et=Object(u["a"])([d["a"]],Et);var St=Et,Ct=St,Tt=Object(m["a"])(Ct,kt,jt,!1,null,"9d4543ea",null),It=Tt.exports,Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",{staticClass:"store-map",class:"store-map-"+this.size},[a("thead",[a("tr",[a("th"),t._l(t.map.width,(function(e,i){return a("th",{key:i},[t._v(t._s(t.getColumnLetter(i)))])}))],2)]),t._l(t.tileRows,(function(e,i){return a("tr",{key:e.y},[a("th",[t._v(t._s(i+1))]),t._l(e.tiles,(function(e){return a("td",{key:e.x,style:t.getColorCSS(t.colors,e),attrs:{title:t.showTooltips?t.getTitle(e):null},on:{click:function(a){return t.registerClick(e)}}},[t._v(t._s(e.key))])}))],2)}))],2)},Lt=[],At=(a("d81d"),a("4ec9"),a("25f0"),a("3ca3"),a("ddb0"),a("2b3d"),a("0ecf")),Mt=a.n(At),Ft=a("1953"),Dt=a.n(Ft);function Rt(t){var e="string"===typeof t?it()(t):t;return e.tz(it.a.tz.guess()).utc().toISOString()}it.a.extend(Mt.a),it.a.extend(Dt.a);var Nt,zt=function t(e,a,i){Object(r["a"])(this,t),this.id=null,this.width=0,this.height=0,this.id=e,this.width=a,this.height=i},Bt=function(){function t(e,a,i,n,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];Object(r["a"])(this,t),this.id=e,this.x=a,this.y=i,this.tile_type=n,this.subaisle=s,this.color=o,this.color_is_light=l}return Object(o["a"])(t,null,[{key:"fromMapTile",value:function(e){return new t(e.id,e.x,e.y,e.tileType,e.subaisle)}}]),t}();(function(t){t["ENTRANCE"]="entrance",t["EXIT"]="exit",t["ENTRANCE_EXIT"]="ee",t["REGISTER"]="register",t["PRODUCT"]="product",t["SUBAISLE"]="subaisle",t["SPACE"]="space",t["BLOCK"]="block"})(Nt||(Nt={}));var $t=new Map;function Ut(t){return $t.get(t)||"?"}function Ht(t){if(t>=26){var e=Math.floor(t/26)-1,a=t%26;return String.fromCharCode(65+e,65+a)}return String.fromCharCode(65+t)}$t.set(Nt.ENTRANCE,gettext("Entrance")),$t.set(Nt.EXIT,gettext("Exit")),$t.set(Nt.ENTRANCE_EXIT,gettext("Entrance + Exit")),$t.set(Nt.REGISTER,gettext("Cash register")),$t.set(Nt.PRODUCT,gettext("Product shelf (without subaisle)")),$t.set(Nt.SPACE,gettext("Space between aisles")),$t.set(Nt.SUBAISLE,gettext("Subaisle")),$t.set(Nt.BLOCK,gettext("Inaccessible tile"));var Wt=function(){function t(e,a,i,n,s){Object(r["a"])(this,t),this.id=e,this.x=a,this.y=i,this.tileType=n,this.subaisle=s}return Object(o["a"])(t,[{key:"key",get:function(){return null===this.subaisle?"":this.subaisle.display_code}},{key:"letterCoords",get:function(){return"".concat(Ht(this.x)).concat(this.y+1)}},{key:"tileText",get:function(){return null===this.subaisle?Ut(this.tileType):this.subaisle.name}},{key:"letterCoordsWithText",get:function(){return"".concat(this.letterCoords,": ").concat(this.tileText)}}],[{key:"fromDTO",value:function(e){return new t(e.id,e.x,e.y,e.tile_type,e.subaisle)}}]),t}(),Gt=function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(r["a"])(this,t),this.y=e,this.tiles=a},qt=function(){function t(e,a,i,n){Object(r["a"])(this,t),this.id=e,this.width=a,this.height=i,this.tiles=n}return Object(o["a"])(t,[{key:"toMapDTO",value:function(){return new zt(this.id,this.width,this.height)}}],[{key:"fromDTOs",value:function(e,a){return new t(e.id,e.width,e.height,a.map((function(t){return new Wt(t.id,t.x,t.y,t.tile_type,t.subaisle)})))}}]),t}(),Vt=function t(e,a,i){Object(r["a"])(this,t),this.map=e,this.tiles=a,this.date=i};function Xt(t,e,a,i){return Kt.apply(this,arguments)}function Kt(){return Kt=Object(pt["a"])(regeneratorRuntime.mark((function t(e,a,i,n){var s,r,o,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=new Vt(a,i,n),r=JSON.stringify(s),o=document.querySelector("[name=csrfmiddlewaretoken]").value,l=new Headers,l.set("X-CSRFToken",o),t.next=7,fetch(e,{credentials:"same-origin",method:"POST",body:r,headers:l});case 7:return c=t.sent,t.abrupt("return",c.json());case 9:case"end":return t.stop()}}),t)}))),Kt.apply(this,arguments)}function Qt(t){return t.sort((function(t,e){return t.x-e.x||t.y-e.y}))}var Yt,Jt,Zt=a("7b1a"),te=a.n(Zt);(function(t){t[t["SECTION_HEADER"]=0]="SECTION_HEADER",t[t["AISLE"]=1]="AISLE",t[t["SUBAISLE"]=2]="SUBAISLE",t[t["SPECIAL_TILE"]=3]="SPECIAL_TILE"})(Yt||(Yt={})),function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["ENTRANCE"]=-2]="ENTRANCE",t[t["EXIT"]=-3]="EXIT",t[t["ENTRANCE_EXIT"]=-4]="ENTRANCE_EXIT",t[t["REGISTER"]=-5]="REGISTER",t[t["PRODUCT"]=-6]="PRODUCT",t[t["SUBAISLE"]=-7]="SUBAISLE",t[t["BLOCK"]=-8]="BLOCK",t[t["SPACE"]=0]="SPACE"}(Jt||(Jt={}));var ee=function t(e,a){Object(r["a"])(this,t),this.color=e,this.isLight=a},ae=function t(e,a,i,n,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];Object(r["a"])(this,t),this.color=null,this.id=null,this.tileType=null,this.subaisle=null,this.canActivate=!0,this.title=e,this.key=a,this.color=i,this.id=n,this.type=s,this.tileType=o,this.subaisle=l,this.canActivate=c};function ie(t){switch(t){case Nt.ENTRANCE:return Jt.ENTRANCE;case Nt.EXIT:return Jt.EXIT;case Nt.ENTRANCE_EXIT:return Jt.ENTRANCE_EXIT;case Nt.REGISTER:return Jt.REGISTER;case Nt.PRODUCT:return Jt.PRODUCT;case Nt.SUBAISLE:return Jt.SUBAISLE;case Nt.SPACE:return Jt.SPACE;case Nt.BLOCK:return Jt.BLOCK;default:return Jt.UNKNOWN}}var ne=new Map;function se(t){var e=new Map;return ne.forEach((function(t,a){return e.set(a,t)})),t.forEach((function(t){t.subaisles.forEach((function(t){e.set(t.id,te()(t.id+t.name,{format:"hex"}))}))})),e}function re(t,e){var a=[];function i(t){var a=Ut(t),i=ie(t);return new ae(a,a,e.get(i)||null,null,Yt.SPECIAL_TILE,t)}return t.length>0&&a.push(new ae(gettext("Aisles"),"h1",null,null,Yt.SECTION_HEADER)),t.forEach((function(t){a.push(new ae(t.name,"a".concat(t.id),null,t.id,Yt.AISLE)),t.subaisles.forEach((function(t){a.push(new ae(t.name,"sa".concat(t.id),e.get(t.id)||null,t.id,Yt.SUBAISLE,Nt.SUBAISLE,t))}))})),a.push(new ae(gettext("Special tiles"),"h2",null,null,Yt.SECTION_HEADER)),a.push(i(Nt.ENTRANCE)),a.push(i(Nt.EXIT)),a.push(i(Nt.ENTRANCE_EXIT)),a.push(i(Nt.REGISTER)),a.push(i(Nt.PRODUCT)),a.push(i(Nt.SPACE)),a.push(i(Nt.BLOCK)),a}function oe(t,e){var a;if(a=null!==e.subaisle?t.get(e.subaisle.id):t.get(ie(e.tileType)),void 0===a&&(a=t.get(Jt.UNKNOWN)),void 0===a)throw new Error("Invalid color map");return a}function le(t){var e=t.isLight?"black":"white";return"background-color:".concat(t.color,";color:").concat(e)}function ce(t,e){return le(oe(t,e))}function ue(t,e){var a,i;if(null===e)a="#ff0000",i=!0;else{var n=oe(e,t);a=n.color,i=n.isLight}return new Bt(t.id,t.x,t.y,t.tileType,t.subaisle,a,i)}ne.set(Jt.ENTRANCE,new ee("#3BF5C0",!0)),ne.set(Jt.EXIT,new ee("#68DE2A",!0)),ne.set(Jt.ENTRANCE_EXIT,new ee("#74F52F",!0)),ne.set(Jt.REGISTER,new ee("#2A66DE",!0)),ne.set(Jt.PRODUCT,new ee("#AF30FF",!0)),ne.set(Jt.SPACE,new ee("#E9ECEF",!0)),ne.set(Jt.SUBAISLE,new ee("#495057",!1)),ne.set(Jt.BLOCK,new ee("#000000",!1)),ne.set(Jt.UNKNOWN,new ee("#495057",!1));var de=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.tileRows=[],t}return Object(o["a"])(a,[{key:"mounted",value:function(){this.updateRows()}},{key:"updateRows",value:function(){var t=this;this.tileRows=[];for(var e=0;e<this.map.height;e+=1)this.tileRows.push(new Gt(e));var a=Qt(this.map.tiles);a.forEach((function(e){return t.tileRows[e.y].tiles.push(e)}))}},{key:"getTitle",value:function(t){var e;return null!==t.subaisle?(e=t.subaisle.name,t.subaisle.display_code&&(e+=" (".concat(t.subaisle.display_code,")"))):e=Ut(t.tileType),"".concat(t.letterCoords,": ").concat(e)}},{key:"registerClick",value:function(t){this.$emit("tileClicked",t)}},{key:"getColumnLetter",value:function(t){return Ht(t)}},{key:"getColorCSS",value:function(t,e){return this.colors.size>0?ce(t,e):"background-color:gray"}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],de.prototype,"map",void 0),Object(u["a"])([Object(d["b"])()],de.prototype,"colors",void 0),Object(u["a"])([Object(d["b"])()],de.prototype,"editable",void 0),Object(u["a"])([Object(d["b"])()],de.prototype,"showTooltips",void 0),Object(u["a"])([Object(d["b"])({default:"regular"})],de.prototype,"size",void 0),Object(u["a"])([Object(d["d"])("map")],de.prototype,"updateRows",null),de=Object(u["a"])([d["a"]],de);var pe=de,he=pe,ve=Object(m["a"])(he,Pt,Lt,!1,null,"e9261d80",null),me=ve.exports,ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",{staticClass:"store-map-legend"},[t.editable?a("tr",{staticClass:"store-map-legend-item",class:{active:t.isActive(null)}},[a("td",{staticClass:"store-map-legend-tile store-map-legend-tile-cursor",on:{click:function(e){return t.activateEntry(null)}}}),a("td",{staticClass:"store-map-legend-title",on:{click:function(e){return t.activateEntry(null)}}},[t._v(t._s(t.getText("Cursor (no changes)")))])]):t._e(),t._l(t.entries,(function(e){return a("tbody",{key:e.key},[a("tr",{staticClass:"store-map-legend-item",class:{active:t.isActive(e)}},[t.isSubaisle(e)||t.isSpecialTile(e)?a("td",{staticClass:"store-map-legend-tile",style:t.getColorCSSForEntry(e),on:{click:function(a){return t.activateEntry(e)}}}):t.isSectionHeader(e)||t.isAisle(e)?t._e():a("td",{staticClass:"store-map-legend-tile-blank"}),t.isSectionHeader(e)?a("td",{staticClass:"h5",attrs:{colspan:"2"}},[t._v(t._s(e.title))]):t.isAisle(e)?a("td",{staticClass:"h6",attrs:{colspan:"2"}},[t._v(t._s(e.title))]):a("td",{staticClass:"store-map-legend-title",on:{click:function(a){return t.activateEntry(e)}}},[t._v(t._s(e.title))])]),t.isAisle(e)||t.isSectionHeader(e)?a("tr"):t._e()])}))],2)},fe=[],be=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.activeEntry=null,t.entries=[],t}return Object(o["a"])(a,[{key:"mounted",value:function(){this.updateEntries()}},{key:"updateEntries",value:function(){this.entries=re(this.aisles,this.colors)}},{key:"getColorCSSForEntry",value:function(t){return null===t.color?"":le(t.color)}},{key:"isSectionHeader",value:function(t){return t.type===Yt.SECTION_HEADER}},{key:"isAisle",value:function(t){return t.type===Yt.AISLE}},{key:"isSubaisle",value:function(t){return t.type===Yt.SUBAISLE}},{key:"isSpecialTile",value:function(t){return t.type===Yt.SPECIAL_TILE}},{key:"isActive",value:function(t){var e;return this.editable&&(null===t||void 0===t?void 0:t.key)===(null===(e=this.activeEntry)||void 0===e?void 0:e.key)}},{key:"activateEntry",value:function(t){void 0===t||null!==t&&!t.canActivate||(this.activeEntry=t,this.$emit("activateEntry",t))}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],be.prototype,"aisles",void 0),Object(u["a"])([Object(d["b"])()],be.prototype,"colors",void 0),Object(u["a"])([Object(d["b"])()],be.prototype,"editable",void 0),Object(u["a"])([Object(d["d"])("aisles"),Object(d["d"])("colors")],be.prototype,"updateEntries",null),be=Object(u["a"])([d["a"]],be);var ye=be,_e=ye,xe=Object(m["a"])(_e,ge,fe,!1,null,"58b99bd2",null),we=xe.exports,Oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-8"},[a("MapDisplay",{ref:"display",attrs:{map:t.map,colors:t.colors,editable:t.editable,showTooltips:t.showTooltips,size:t.size},on:{tileClicked:t.paintTile}})],1),a("div",{staticClass:"col-md-4"},[a("MapLegend",{attrs:{aisles:t.aisles,colors:t.colors,editable:t.editable},on:{activateEntry:t.activateEntry}})],1)])},ke=[],je=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.activeEntry=null,t.colors=new Map,t}return Object(o["a"])(a,[{key:"mounted",value:function(){this.updateColors()}},{key:"getRows",value:function(){var t=this.$refs.display;return t.tileRows}},{key:"updateRows",value:function(){var t=this.$refs.display;t.updateRows()}},{key:"updateColors",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.colors=se(t||this.aisles)}},{key:"activateEntry",value:function(t){this.activeEntry=t}},{key:"paintTile",value:function(t){this.editable||this.$emit("tileClicked",t),null!==this.activeEntry&&this.editable&&(this.activeEntry.type===Yt.SUBAISLE?(t.tileType=Nt.SUBAISLE,t.subaisle=this.activeEntry.subaisle):this.activeEntry.type===Yt.SPECIAL_TILE&&null!==this.activeEntry.tileType&&(t.tileType=this.activeEntry.tileType,t.subaisle=null))}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],je.prototype,"map",void 0),Object(u["a"])([Object(d["b"])()],je.prototype,"aisles",void 0),Object(u["a"])([Object(d["b"])()],je.prototype,"editable",void 0),Object(u["a"])([Object(d["b"])()],je.prototype,"showTooltips",void 0),Object(u["a"])([Object(d["b"])({default:"regular"})],je.prototype,"size",void 0),je=Object(u["a"])([d["a"]],je);var Ee=je,Se=Ee,Ce=Object(m["a"])(Se,Oe,ke,!1,null,"38ac3bf4",null),Te=Ce.exports,Ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"local-permissions-table-container"}},[a("table",{staticClass:"table table-hover"},[a("thead",[a("tr",t._l(t.headers(),(function(e){return a("th",{key:e[0],class:e[1]},[t._v(t._s(e[0]))])})),0)]),a("tbody",[t._l(t.appData.lpEntries,(function(e){return a("tr",{key:e.store},[a("td",[t._v(t._s(e.name))]),t._l(t.permKeys,(function(i){return a("td",{key:i,staticClass:"text-center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e[i],expression:"entry[permKey]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e[i])?t._i(e[i],null)>-1:e[i]},on:{change:function(a){var n=e[i],s=a.target,r=!!s.checked;if(Array.isArray(n)){var o=null,l=t._i(n,o);s.checked?l<0&&t.$set(e,i,n.concat([o])):l>-1&&t.$set(e,i,n.slice(0,l).concat(n.slice(l+1)))}else t.$set(e,i,r)}}})])})),a("td",[a("TabItemDelete",{attrs:{item:e.id},on:{delete:t.deleteItem}})],1)],2)})),a("tr",[a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.newEntryStore,expression:"newEntryStore"}],staticClass:"w-100",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.newEntryStore=e.target.multiple?a:a[0]}}},[a("optgroup",{attrs:{label:t.optGroupLabel}},t._l(t.filteredStoreList,(function(e){return a("option",{key:e.id,domProps:{value:e}},[t._v(" "+t._s(e.name)+" ")])})),0)])]),t._l(t.permKeys,(function(e){return a("td",{key:e,staticClass:"text-center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newEntry[e],expression:"newEntry[permKey]"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.newEntry[e])?t._i(t.newEntry[e],null)>-1:t.newEntry[e]},on:{change:function(a){var i=t.newEntry[e],n=a.target,s=!!n.checked;if(Array.isArray(i)){var r=null,o=t._i(i,r);n.checked?o<0&&t.$set(t.newEntry,e,i.concat([r])):o>-1&&t.$set(t.newEntry,e,i.slice(0,o).concat(i.slice(o+1)))}else t.$set(t.newEntry,e,s)}}})])})),a("td",{staticClass:"text-left"},[a("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"button",disabled:null===t.newEntryStore},on:{click:t.addNewItem}},[a("IconBox",{attrs:{icon:"plus",size:"12",text:this.getText("Add")}})],1)])],2)],2)]),a("input",{attrs:{type:"hidden",name:"local_permissions_json"},domProps:{value:t.entriesAsJson}})])},Pe=[],Le=(a("4de4"),a("5db7"),a("73d9"),a("6062"),a("2909")),Ae=function t(){Object(r["a"])(this,t),this.id=-1,this.name="",this.can_manage_products=!1,this.can_manage_maps=!1,this.can_manage_deals=!1,this.can_manage_employees=!1,this.can_view_statistics=!1};function Me(){return Fe.apply(this,arguments)}function Fe(){return Fe=Object(pt["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/stores/");case 2:return e=t.sent,t.abrupt("return",e.json());case 4:case"end":return t.stop()}}),t)}))),Fe.apply(this,arguments)}var De=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.storeList=[],t.newEntry=new Ae,t.newEntryStore=null,t}return Object(o["a"])(a,[{key:"mounted",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==this.storeList.length){t.next=4;break}return t.next=3,Me();case 3:this.storeList=t.sent;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"headers",value:function(){var t=this.appData.lpTableTitles.map((function(t){return[t[1],"text-center"]}));return[[gettext("Store"),"text-left"]].concat(Object(Le["a"])(t),[[gettext("Actions"),"text-left"]])}},{key:"addNewItem",value:function(){null!==this.newEntryStore&&(this.newEntry.id=this.newEntryStore.id,this.newEntry.name=this.newEntryStore.name,this.appData.lpEntries.push(this.newEntry),this.newEntryStore=null,this.newEntry=new Ae)}},{key:"deleteItem",value:function(t){this.appData.lpEntries=this.appData.lpEntries.filter((function(e){return e.id!==t}))}},{key:"entriesAsJson",get:function(){return JSON.stringify(this.appData.lpEntries)}},{key:"filteredStoreList",get:function(){var t=new Set(this.appData.lpEntries.map((function(t){return t.id})));return this.storeList.filter((function(e){return!t.has(e.id)}))}},{key:"optGroupLabel",get:function(){return 0===this.filteredStoreList.length?gettext("(Permissions added for all stores)"):gettext("Select store to add…")}},{key:"permKeys",get:function(){return this.appData.lpTableTitles.flatMap((function(t){return t[0]}))}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],De.prototype,"appData",void 0),De=Object(u["a"])([d["a"]],De);var Re=De,Ne=Re,ze=Object(m["a"])(Ne,Ie,Pe,!1,null,"2f086a44",null),Be=ze.exports,$e=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[0!==t.selected.length?a("span",{staticClass:"mr-1 comma-separated-links"},t._l(t.selected,(function(e){return a("a",{key:e.id,attrs:{href:e.details_url,target:"_blank"}},[t._v(t._s(e.name))])})),0):t._e(),t.showBlankRequiredField()?a("input",{staticClass:"invisible-input",attrs:{required:!0,value:""}}):t._e(),t._l(t.selected,(function(e){return a("input",{key:e.id,attrs:{name:t.appData.misInputName,type:"hidden"},domProps:{value:e.id}})})),a("ModalLauncher",{attrs:{modalId:t.appData.misModalId,id:"id_"+t.appData.misInputName,className:"btn btn-outline-primary"}},[t._v(t._s(t.getText("Select…")))]),a("ModalBox",{attrs:{modalId:t.appData.misModalId,sizeClass:"modal-lg",title:t.appData.misTitle,showFooter:t.appData.misMultipleSelection},on:{modalAccept:t.handleAccept}},[a("label",{staticClass:"sr-only",attrs:{for:t.appData.misModalId+"Search"}},[t._v(t._s(t.getText("Search")))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"form-control",attrs:{type:"search",id:t.appData.misModalId+"Search",placeholder:t.getText("Search")},domProps:{value:t.searchQuery},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}}),a("table",{staticClass:"table table-hover table-vam"},[a("thead",[a("tr",[a("th",[t._v(t._s(t.getText("Select")))]),a("th",[t._v(t._s(t.appData.misItemName))]),t._l(t.appData.misExtraFieldNames,(function(e){return a("th",{key:e},[t._v(t._s(e))])})),a("th",[t._v(t._s(t.getText("Actions")))])],2)]),a("tbody",t._l(t.itemList,(function(e){return a("tr",{key:e.id},[a("td",[a("button",{class:{btn:!0,"btn-success":!t.appData.misMultipleSelection||t.isSelected(e),"btn-outline-success":t.appData.misMultipleSelection&&!t.isSelected(e)},attrs:{type:"button"},on:{click:function(a){return t.handleSelectDeselect(e)}}},[t._v(t._s(t.getText("Select")))])]),a("td",[null!=e.photo?a("img",{staticClass:"mis-image",attrs:{src:e.photo,alt:e.name}}):t._e(),t._v(" "+t._s(e.name))]),t._l(e.extras,(function(e){return a("td",{key:e},[t._v(t._s(e))])})),a("td",[a("a",{staticClass:"btn btn-outline-info",attrs:{href:e.details_url,target:"_blank"}},[t._v(t._s(t.getText("Details")))])])],2)})),0)]),a("Pagination",{attrs:{currentPage:t.itemPage,maxPages:t.maxPages},on:{back:t.goBack,forward:t.goForward}}),t.showLoading||0!==t.itemList.length?t._e():a("div",{staticClass:"text-center"},[t._v(" "+t._s(t.getText("No results found."))+" ")]),t.showLoading?a("div",{staticClass:"text-center"},[a("IconBox",{attrs:{text:t.getText("Loading…"),icon:"hourglass-split",size:"16"}})],1):t._e()],1)],2)},Ue=[];a("7db0");function He(t,e,a){return We.apply(this,arguments)}function We(){return We=Object(pt["a"])(regeneratorRuntime.mark((function t(e,a,i){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new URL(e,document.location.toString()),n.searchParams.set("q",i),n.searchParams.set("page",a.toString()),t.next=5,fetch(n.toString(),{credentials:"same-origin"});case 5:return s=t.sent,t.abrupt("return",s.json());case 7:case"end":return t.stop()}}),t)}))),We.apply(this,arguments)}var Ge=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.showLoading=!0,t.itemList=[],t.searchQuery="",t.itemPage=1,t.maxPages=1,t.selected=[],t.newSelection=[],t.selectionsCopied=!1,t}return Object(o["a"])(a,[{key:"mounted",value:function(){var t=this;this.selectionsCopied||(this.selected=this.appData.misInitialSelection,this.selectionsCopied=!0),this.jQueryModal=jQuery("#".concat(this.appData.misModalId)),this.jQueryModal.on("show.bs.modal",(function(){t.newSelection=t.selected,t.itemPage=1,t.searchQuery="",t.loadData()}))}},{key:"loadData",value:function(){var t=this;this.showLoading=!0,He(this.appData.misApiEndpoint,this.itemPage,this.searchQuery).then((function(e){t.itemList=e.items,t.maxPages=e.num_pages,t.itemPage=e.page,t.showLoading=!1,t.jQueryModal.modal("handleUpdate")}))}},{key:"goBack",value:function(){this.itemPage>1&&(this.itemPage-=1)}},{key:"goForward",value:function(){this.itemPage<this.maxPages&&(this.itemPage+=1)}},{key:"handleAccept",value:function(){this.selected=this.newSelection,this.jQueryModal.modal("hide")}},{key:"isSelected",value:function(t){return void 0!==this.newSelection.find((function(e){return e.id===t.id}))}},{key:"showBlankRequiredField",value:function(){return this.appData.misRequired&&0===this.selected.length}},{key:"handleSelectDeselect",value:function(t){this.appData.misMultipleSelection?this.isSelected(t)?this.newSelection=this.newSelection.filter((function(e){return e.id!==t.id})):this.newSelection.push(t):(this.selected=[t],this.jQueryModal.modal("hide"))}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Ge.prototype,"appData",void 0),Object(u["a"])([Object(d["d"])("searchQuery"),Object(d["d"])("itemPage")],Ge.prototype,"loadData",null),Ge=Object(u["a"])([d["a"]],Ge);var qe=Ge,Ve=qe,Xe=Object(m["a"])(Ve,$e,Ue,!1,null,null,null),Ke=Xe.exports,Qe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("input",{ref:"outputFormField",attrs:{name:"extra_metadata_raw",type:"hidden"},domProps:{value:t.outputExtraMetadata()}}),a("table",{staticClass:"table table-hover table-vam"},[a("thead",[a("tr",[a("th",{attrs:{width:"45%"}},[t._v(t._s(t.getText("Field")))]),a("th",{attrs:{width:"45%"}},[t._v(t._s(t.getText("Value")))]),a("th",{attrs:{width:"10%"}},[t._v(t._s(t.getText("Actions")))])])]),a("tbody",[t._l(t.itemList,(function(e){return a("tr",{key:e.id},[a("td",[""===e.slug&&t.appData.emeHighlightCustom?a("span",{staticClass:"text-warning mr-1"},[t._v("★")]):t._e(),t._v(" "+t._s(e.name))]),a("td",[a("ExtraMetadataEditorInput",{attrs:{item:e}})],1),a("td",[a("TabItemDelete",{attrs:{item:e.id},on:{delete:t.deleteItem}})],1)])})),a("tr",[t._m(0),a("td",[a("ExtraMetadataEditorInput",{attrs:{item:t.newItem}})],1),a("td",[a("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"button",disabled:!t.canAddItem()},on:{click:t.addItem}},[a("IconBox",{attrs:{icon:"plus",text:t.getText("Add"),size:"12"}})],1)])])],2)]),t.showLoading?a("div",{staticClass:"text-center"},[a("IconBox",{attrs:{text:t.getText("Loading…"),icon:"hourglass-split",size:"16"}})],1):t._e(),t.showValidationError?a("div",{staticClass:"text-danger"},[a("IconBox",{attrs:{text:t.getValidationErrorText(),icon:"x-circle-fill",size:"16"}})],1):t._e()])},Ye=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",[a("select",{staticClass:"extra-metadata-new-select"},[a("option",{attrs:{value:""}},[t._v("---------")])])])}],Je=(a("a15b"),a("a9e3"),a("9129"),function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.showLoading=!1,t.showValidationError=!1,t.requiredFieldsMissing=[],t.itemList=[],t.standardFields=new mt,t.standardFieldsMap=new Map,t.standardFieldSlugs=new Set,t.standardFieldsFromSubcategory=!1,t.subcategorySelect=null,t.newItem=new vt,t.lastId=0,t}return Object(o["a"])(a,[{key:"buildStandardFieldsMap",value:function(){var t=this;this.standardFieldsMap=new Map,this.standardFields.items.forEach((function(e){return t.standardFieldsMap.set(e.slug,e)}))}},{key:"buildStandardFieldSlugs",value:function(){var t=this;this.standardFieldSlugs=new Set,this.standardFields.items.forEach((function(e){return t.standardFieldSlugs.add(e.slug)}))}},{key:"updateItemListWithStandardFields",value:function(){var t=this;this.itemList.forEach((function(e){e.standardMetaField=t.getStandardMetaField(e)}))}},{key:"getStandardMetaField",value:function(t){var e=this.standardFieldsMap.get(t.slug);return void 0===e?null:e}},{key:"mounted",value:function(){var t=this;this.addHandlerToSubmit(),this.itemList=this.appData.emeInitialData.map((function(t,e){return vt.toInternal(t,e,null)})),this.lastId=this.itemList.length-1,this.appData.emeUseSubcategory?(this.subcategorySelect=document.querySelector("select[name='subcategory']"),null!==this.subcategorySelect?(this.getStandardFieldsData(this.subcategorySelect.value),this.subcategorySelect.addEventListener("change",(function(){null!==t.subcategorySelect&&t.getStandardFieldsData(t.subcategorySelect.value)}))):this.getStandardFieldsData(null)):this.getStandardFieldsData(null);var e=$(".extra-metadata-new-select");e.select2({theme:"bootstrap4",width:"100%",tags:!0}),e.on("select2:select",(function(a){var i=e.select2("data")[0];t.newItem.slug=t.standardFieldSlugs.has(i.id)?i.id:"",t.newItem.name=i.text,t.newItem.units="",t.newItem.standardMetaField=t.getStandardMetaField(t.newItem)}))}},{key:"getStandardFieldsData",value:function(t){var e=this;this.showLoading=!0;var a=t;"string"===typeof a&&(a=parseInt(a,10)),null!==a&&(a<=0||Number.isNaN(a))&&(a=null),gt(this.appData.emeApiEndpoint,a).then((function(a){e.showLoading=!1,e.standardFields=a,e.standardFieldsFromSubcategory=null!==t,e.updateSelect2(),e.buildStandardFieldsMap(),e.buildStandardFieldSlugs(),e.updateItemListWithStandardFields()}))}},{key:"updateSelect2",value:function(){var t=this,e=$(".extra-metadata-new-select");e.html("").trigger("change");var a=new Option("---------","",!1,!1);e.append(a).trigger("change");var i=new Set(this.itemList.map((function(t){return t.slug})));this.standardFields.items.forEach((function(a){if(!i.has(a.slug)){var n=new Option(t.getNameWithReq(a),a.slug,!1,!1);e.append(n).trigger("change")}})),e.val(this.newItem.slug).trigger("change")}},{key:"addItem",value:function(){if(this.canAddItem()){if(this.newItem.id=this.lastId,""!==this.newItem.slug){var t,e=null===(t=this.standardFieldsMap.get(this.newItem.slug))||void 0===t?void 0:t.name;this.newItem.name=void 0!==e?e:this.newItem.name}this.lastId+=1,this.itemList.push(this.newItem),this.newItem=new vt,$(".extra-metadata-new-select").val("").trigger("change"),this.updateSelect2()}}},{key:"canAddItem",value:function(){var t,e,a=null===(t=this.newItem.standardMetaField)||void 0===t?void 0:t.expected_units_names;return void 0!==a&&a.length>0&&"_bool"!==(null===(e=this.newItem.standardMetaField)||void 0===e?void 0:e.expected_units)?""!==this.newItem.units&&""!==this.newItem.value:""!==this.newItem.value}},{key:"deleteItem",value:function(t){this.itemList=this.itemList.filter((function(e){return e.id!==t})),this.updateSelect2()}},{key:"getNameWithReq",value:function(t){var e=t.name;return t.is_required&&(e+=" *"),e}},{key:"outputExtraMetadata",value:function(){return JSON.stringify(this.itemList.map((function(t){return t.toGeneral()})))}},{key:"addHandlerToSubmit",value:function(){var t=this.$refs.outputFormField;null!==t.form&&t.form.addEventListener("submit",this.validateForm)}},{key:"validateForm",value:function(t){var e=this,a=!0;if(this.requiredFieldsMissing=[],this.standardFieldsFromSubcategory){var i=new Set(this.standardFields.items.map((function(t){return t.name})));this.itemList.forEach((function(t){i.delete(t.name)})),i.size>0&&(a=!1,i.forEach((function(t){return e.requiredFieldsMissing.push(t)})))}return this.showValidationError=!a,a||t.preventDefault(),a}},{key:"getValidationErrorText",value:function(){return 0===this.requiredFieldsMissing.length?gettext("An unexpected validation error occurred."):gettext("The following required fields are missing: ")+this.requiredFieldsMissing.join(", ")}}]),a}(d["c"]));Object(u["a"])([Object(d["b"])()],Je.prototype,"appData",void 0),Je=Object(u["a"])([d["a"]],Je);var Ze,ta=Je,ea=ta,aa=Object(m["a"])(ea,Qe,Ye,!1,null,null,null),ia=aa.exports,na=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"collapse pb-2",attrs:{id:"store-map"}},[a("div",{staticClass:"card"},[null!==t.storeMap?a("div",{staticClass:"card-body"},[a("h5",{staticClass:"card-title"},[t._v(t._s(t.getText("Store map")))]),a("MapDisplayWithLegend",{attrs:{map:t.storeMap,aisles:t.aisleStructure,editable:!1,showTooltips:!0,size:"regular"},on:{tileClicked:t.setTileFromClick}})],1):a("div",{staticClass:"card-body"},[a("p",[t._v(t._s(t.getText("No map is available for this store at the selected validity time.")))])])])]),a("div",{staticClass:"card-box card-box-top"},[a("form",{staticClass:"form-inline align-content-center flex-column",attrs:{action:"",method:"GET"}},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"btn-group mr-2",attrs:{role:"group","aria-label":t.getText("Filters")}},t._l(t.FILTER_OPTIONS_,(function(e){return a("button",{key:e[0],staticClass:"btn btn-outline-primary",class:{active:t.filter===e[0]},attrs:{type:"button"},on:{click:function(a){t.filter=e[0]}}},[t._v(t._s(e[1]))])})),0)]),a("div",{staticClass:"d-flex mt-2"},[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nameSearch,expression:"nameSearch"}],staticClass:"form-control mr-2",attrs:{placeholder:t.getText("Name"),id:"name-search"},domProps:{value:t.nameSearch},on:{input:function(e){e.target.composing||(t.nameSearch=e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.vendorSearch,expression:"vendorSearch"}],staticClass:"form-control mr-2",attrs:{placeholder:t.getText("Vendor"),id:"vendor-search"},domProps:{value:t.vendorSearch},on:{input:function(e){e.target.composing||(t.vendorSearch=e.target.value)}}}),a("select",{directives:[{name:"model",rawName:"v-model",value:t.subcategorySearch,expression:"subcategorySearch"}],staticClass:"form-control mr-2",attrs:{id:"subcategory-search"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.subcategorySearch=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"0"}},[t._v(t._s(t.getText("Select subcategory")))]),t._l(t.categoryStructure,(function(e){return a("optgroup",{key:e.id,attrs:{label:e.name}},t._l(e.subcategories,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)}))],2)]),a("div",{staticClass:"vertical-divider ml-3 pl-3"},[a("label",{staticClass:"mr-2 d-inline",attrs:{for:"items-per-page"}},[t._v(t._s(t.getText("Items per page:")))]),a("select",{directives:[{name:"model",rawName:"v-model.number",value:t.itemsPerPage,expression:"itemsPerPage",modifiers:{number:!0}}],staticClass:"form-control mr-2",attrs:{id:"items-per-page"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(e){var a="_value"in e?e._value:e.value;return t._n(a)}));t.itemsPerPage=e.target.multiple?a:a[0]}}},[a("option",{domProps:{value:10}},[t._v("10")]),a("option",{domProps:{value:30}},[t._v("30")]),a("option",{domProps:{value:50}},[t._v("50")])]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button","data-toggle":"collapse","data-target":"#store-map","aria-expanded":"false","aria-controls":"store-map"}},[t._v(" "+t._s(t.getText("Show/hide store map"))+" ")])])])])]),a("table",{staticClass:"table table-hover table-vam"},[a("tr",[a("th",{staticStyle:{width:"15%"}},[t._v(t._s(t.getText("Product")))]),a("th",{staticStyle:{width:"15%"}},[t._v(t._s(t.getText("Vendor")))]),a("th",{staticStyle:{width:"15%"}},[t._v(t._s(t.getText("Validity")))]),a("th",{staticStyle:{width:"15%"}},[t._v(t._s(t.getText("Subaisle")))]),a("th",{staticStyle:{width:"15%"}},[t._v(t._s(t.getText("Tile")))]),a("th",{staticStyle:{width:"15%"}},[t._v(t._s(t.getText("Actions")))])]),t._l(t.items,(function(e){return a("ProductLocationsTableRow",{key:e.product.id,attrs:{product:e.product,change:e.change,aisleStructure:t.aisleStructure,tileList:t.tileList,isPicking:null!==t.pickingFor&&t.pickingFor.product.id===e.product.id},on:{startPicking:t.startPickingFromMap}})}))],2),0===t.showLoading&&t.initialized&&0===t.items.length?a("div",[a("p",{staticClass:"lead"},[t._v(t._s(t.getText("No results found.")))])]):t._e(),a("MessageDisplay",{ref:"messages"}),a("Pagination",{attrs:{currentPage:t.page,maxPages:t.totalPages},on:{back:t.goBack,forward:t.goForward}}),a("div",{staticClass:"card-box card-box-bottom"},[a("div",{staticClass:"form-inline justify-content-center"},[a("label",{attrs:{for:"valid-at-field"}},[t._v(t._s(t.getText("Changes in effect after:")))]),a("div",{staticClass:"input-group date"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.validAt,expression:"validAt"}],staticClass:"form-control ml-2",attrs:{type:"text",name:"date_started",placeholder:t.getText("Valid from"),title:"",id:"valid-at-field",dp_config:'{"id": "dp_1", "picker_type":\n"DATETIME", "linked_to": null, "options": {"showClose": true,\n"showClear": false, "showTodayButton": true, "format": "YYYY-MM-DD HH:mm:ss"}}'},domProps:{value:t.validAt},on:{input:function(e){e.target.composing||(t.validAt=e.target.value)}}}),t._m(0)]),a("div",{staticClass:"vertical-divider ml-3 pl-3"},[a("button",{staticClass:"btn btn-lg btn-success",attrs:{type:"button"},on:{click:function(e){return t.saveChanges()}}},[a("IconBox",{attrs:{icon:"check",size:"16",text:t.getText("Save")}}),t.changeCount()>0?a("span",[t._v(" ("+t._s(t.changeCount())+")")]):t._e()],1),a("button",{staticClass:"btn btn-lg btn-outline-warning ml-1",attrs:{type:"button"},on:{click:function(e){return t.clearChanges()}}},[a("IconBox",{attrs:{icon:"x-square",size:"16",text:t.getText("Undo all")}})],1)])])]),t.showLoading>0?a("div",{staticClass:"alert alert-secondary mt-1"},[a("IconBox",{attrs:{size:"16",icon:"hourglass-split",text:t.getText("Loading…")}})],1):t._e()],1)},sa=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group-addon input-group-append",attrs:{"data-target":"#datetimepicker1","data-toggle":"datetimepickerv"}},[a("div",{staticClass:"input-group-text"},[a("i",{staticClass:"glyphicon glyphicon-calendar"})])])}],ra=(a("498a"),a("5530"));(function(t){t["ALL"]="all",t["AUTO"]="auto",t["MANUAL"]="manual",t["MISSING"]="missing"})(Ze||(Ze={}));var oa=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];Object(r["a"])(this,t),this.tile=null,this.subaisle=null,this.start_tile=null,this.start_subaisle=null,this.revert_auto=!1,this.delete_location=!1,this.product=e,this.tile=a,this.subaisle=i,this.start_tile=n,this.start_subaisle=s,this.revert_auto=o,this.delete_location=l}return Object(o["a"])(t,[{key:"prepareForUpload",value:function(){var e=Object(ra["a"])(Object(ra["a"])({},this.product),{},{location:null}),a=this.tile;return null!==this.tile&&"tileType"in this.tile&&(a=Bt.fromMapTile(this.tile)),new t(e,a,this.subaisle,null,null,this.revert_auto,this.delete_location)}},{key:"hasChanges",value:function(){return this.hasValueChanges()||this.hasExtrasChanges()}},{key:"hasValueChanges",value:function(){var t,e,a,i;return(null===(t=this.tile)||void 0===t?void 0:t.id)!==(null===(e=this.start_tile)||void 0===e?void 0:e.id)||(null===(a=this.subaisle)||void 0===a?void 0:a.id)!==(null===(i=this.start_subaisle)||void 0===i?void 0:i.id)}},{key:"hasExtrasChanges",value:function(){return this.revert_auto||this.delete_location}}],[{key:"fromProduct",value:function(e){var a,i,n=null===(a=e.location)||void 0===a?void 0:a.tile,s=null===(i=e.location)||void 0===i?void 0:i.subaisle;return new t(e,n,s,n,s)}}]),t}(),la=function t(e,a){Object(r["a"])(this,t),this.product=e,this.change=a};function ca(t,e,a,i,n,s,r,o){return ua.apply(this,arguments)}function ua(){return ua=Object(pt["a"])(regeneratorRuntime.mark((function t(e,a,i,n,s,r,o,l){var c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=new URL(e,document.location.toString()),i.trim().length>0&&c.searchParams.set("q",i.trim()),n.trim().length>0&&c.searchParams.set("vendor",n.trim()),s>0&&c.searchParams.set("subcategory",s.toString()),c.searchParams.set("validAt",Rt(r)),c.searchParams.set("page",o.toString()),c.searchParams.set("page_size",l.toString()),c.searchParams.set("filter",a),t.next=10,fetch(c.toString(),{credentials:"same-origin"});case 10:return u=t.sent,t.abrupt("return",u.json());case 12:case"end":return t.stop()}}),t)}))),ua.apply(this,arguments)}function da(t,e){return pa.apply(this,arguments)}function pa(){return pa=Object(pt["a"])(regeneratorRuntime.mark((function t(e,a){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new URL(e,document.location.toString()),i.searchParams.set("validAt",Rt(a)),t.next=4,fetch(i.toString(),{credentials:"same-origin"});case 4:return n=t.sent,t.abrupt("return",n.json());case 6:case"end":return t.stop()}}),t)}))),pa.apply(this,arguments)}function ha(t,e,a){return va.apply(this,arguments)}function va(){return va=Object(pt["a"])(regeneratorRuntime.mark((function t(e,a,i){var n,s,r,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={changes:a,date:Rt(i)},s=JSON.stringify(n),r=document.querySelector("[name=csrfmiddlewaretoken]").value,o=new Headers,o.set("X-CSRFToken",r),t.next=7,fetch(e,{credentials:"same-origin",method:"POST",body:s,headers:o});case 7:return l=t.sent,t.abrupt("return",l.json());case 9:case"end":return t.stop()}}),t)}))),va.apply(this,arguments)}var ma=[[Ze.ALL,gettext("Show all")],[Ze.AUTO,gettext("Auto-assigned")],[Ze.MANUAL,gettext("Manually assigned")],[Ze.MISSING,gettext("Missing location")]],ga=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.items=[],t.aisleStructure=[],t.categoryStructure=[],t.subaisleList=[],t.tileList=[],t.filter=Ze.ALL,t.changes=[],t.changesById=new Map,t.validAt="",t.nameSearch="",t.vendorSearch="",t.subcategorySearch=0,t.page=1,t.totalPages=1,t.itemsPerPage=10,t.showLoading=0,t.storeMap=null,t.initialized=!1,t.FILTER_OPTIONS_=ma,t.pickingFor=null,t}return Object(o["a"])(a,[{key:"mounted",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.filter=this.appData.initialView,this.itemsPerPage=this.appData.defaultPageSize,this.categoryStructure=this.appData.categoryStructure,this.validAt=it()().format(nt),this.initialized=!0,$("#valid-at-field").on("dp.change",(function(t){e.validAt=t.date.format(nt)})),t.next=8,this.updateList(!0);case 8:return t.next=10,this.updateGroups();case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"watcherUpdateList",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.initialized){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.updateList();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"watcherUpdateGroups",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.initialized){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.updateGroups();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateList",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){var e,a,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]&&i[0],0===this.showLoading&&this.messages.clearMessages(),this.showLoading+=1,t.prev=3,t.next=6,ca(this.appData.getEndpoint,this.filter,this.nameSearch,this.vendorSearch,this.subcategorySearch,this.validAt,this.page,this.itemsPerPage);case 6:a=t.sent,t.next=13;break;case 9:return t.prev=9,t.t0=t["catch"](3),this.messages.setError(gettext("Unable to get product data!")),t.abrupt("return");case 13:return t.prev=13,this.showLoading-=1,t.finish(13);case 16:if(this.filter===a.filter){t.next=25;break}if(!e){t.next=21;break}this.filter=a.filter,t.next=25;break;case 21:return this.items=[],this.page=1,this.totalPages=0,t.abrupt("return");case 25:this.updateItems(a.products),this.page=a.page,this.totalPages=a.totalPages;case 28:case"end":return t.stop()}}),t,this,[[3,9,13,16]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateGroups",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return 0===this.showLoading&&this.messages.clearMessages(),this.showLoading+=1,t.prev=2,t.next=5,da(this.appData.groupsEndpoint,this.validAt);case 5:e=t.sent,t.next=13;break;case 8:return t.prev=8,t.t0=t["catch"](2),this.showLoading-=1,this.messages.setError(gettext("Unable to get groups list!")),t.abrupt("return");case 13:this.showLoading-=1,this.aisleStructure=e.aisleStructure,this.subaisleList=e.subaisles,this.storeMap=qt.fromDTOs(e.map,e.tiles),this.tileList=this.storeMap.tiles;case 18:case"end":return t.stop()}}),t,this,[[2,8]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"saveChanges",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.messages.clearMessages(),this.showLoading+=1,e=this.changes.filter((function(t){return t.hasChanges()})).map((function(t){return t.prepareForUpload()})),t.prev=3,t.next=6,ha(this.appData.updateEndpoint,e,this.validAt);case 6:a=t.sent,t.next=14;break;case 9:return t.prev=9,t.t0=t["catch"](3),this.showLoading-=1,this.messages.appendError(gettext("Failed to save changes!")),t.abrupt("return");case 14:if(this.showLoading-=1,!a.success){t.next=22;break}return this.clearEverything(),t.next=19,this.updateList();case 19:this.messages.setSuccessFlash(a.message),t.next=30;break;case 22:if(!a.warning){t.next=29;break}return this.clearEverything(),t.next=26,this.updateList();case 26:this.messages.setWarningFlash(a.message),t.next=30;break;case 29:this.messages.setError(a.message);case 30:case"end":return t.stop()}}),t,this,[[3,9]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateItems",value:function(t){var e=this;this.items=[],t.forEach((function(t){null!==t.location&&null!==t.location.tile&&"tile_type"in t.location.tile&&(t.location.tile=Wt.fromDTO(t.location.tile));var a=e.changesById.get(t.id);void 0===a&&(a=oa.fromProduct(t),e.changes.push(a),e.changesById.set(t.id,a)),e.items.push(new la(t,a))}))}},{key:"clearEverything",value:function(){this.changes=[],this.items=[],this.changesById.clear()}},{key:"clearChanges",value:function(){var t=this;this.changes=[],this.items.forEach((function(e){e.change=oa.fromProduct(e.product),t.changes.push(e.change),t.changesById.set(e.product.id,e.change)}))}},{key:"startPickingFromMap",value:function(t){var e,a,i;(null===(e=t.product)||void 0===e?void 0:e.id)!==(null===(a=this.pickingFor)||void 0===a||null===(i=a.product)||void 0===i?void 0:i.id)?(this.pickingFor=t,$("#store-map").collapse("show")):this.pickingFor=null}},{key:"setTileFromClick",value:function(t){null!==this.pickingFor&&(this.pickingFor.tile=t,this.pickingFor=null)}},{key:"changeCount",value:function(){return this.changes.filter((function(t){return t.hasChanges()})).length}},{key:"goBack",value:function(){this.page>1&&(this.page-=1)}},{key:"goForward",value:function(){this.page<this.totalPages&&(this.page+=1)}},{key:"messages",get:function(){return this.$refs.messages}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],ga.prototype,"appData",void 0),Object(u["a"])([Object(d["d"])("nameSearch"),Object(d["d"])("vendorSearch"),Object(d["d"])("subcategorySearch"),Object(d["d"])("validAt"),Object(d["d"])("filter"),Object(d["d"])("page"),Object(d["d"])("itemsPerPage")],ga.prototype,"watcherUpdateList",null),Object(u["a"])([Object(d["d"])("validAt")],ga.prototype,"watcherUpdateGroups",null),ga=Object(u["a"])([d["a"]],ga);var fa=ga,ba=fa,ya=Object(m["a"])(ba,na,sa,!1,null,"27ba0de9",null),_a=ya.exports,xa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("MapDisplayWithLegend",{attrs:{map:t.map,aisles:t.appData.aisles,editable:!1,showTooltips:!0,size:t.size}}),a("div",{staticClass:"form-inline justify-content-end"},[a("label",{staticClass:"mr-1",attrs:{for:"zoom-map"}},[t._v(t._s(t.getText("Zoom:")))]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.size,expression:"size"}],staticClass:"form-control",attrs:{id:"zoom-map"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.size=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"small"}},[t._v("S")]),a("option",{attrs:{value:"regular"}},[t._v("M")]),a("option",{attrs:{value:"large"}},[t._v("L")])])])],1)},wa=[],Oa=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.map=new qt(null,0,0,[]),t.size="regular",t}return Object(o["a"])(a,[{key:"mounted",value:function(){this.map=qt.fromDTOs(this.appData.map,this.appData.tiles)}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Oa.prototype,"appData",void 0),Oa=Object(u["a"])([d["a"]],Oa);var ka=Oa,ja=ka,Ea=Object(m["a"])(ja,xa,wa,!1,null,"b6512c70",null),Sa=Ea.exports,Ca=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("MapDisplayWithLegend",{ref:"display",staticClass:"mb-2",attrs:{map:t.map,aisles:t.aisles,size:t.size,editable:!0,showTooltips:!0}}),a("MessageDisplay",{ref:"messages"}),a("div",{staticClass:"card-box card-box-bottom"},[a("div",{staticClass:"form-inline justify-content-center"},[a("div",{staticClass:"d-flex flex-column"},[a("label",{attrs:{for:"valid-at-field"}},[t._v(t._s(t.getText("Changes in effect after:")))]),a("div",{staticClass:"input-group date"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.validAt,expression:"validAt"}],staticClass:"form-control",attrs:{type:"text",name:"date_started",placeholder:t.getText("Valid from"),title:"",id:"valid-at-field",dp_config:'{"id": "dp_1", "picker_type":\n"DATETIME", "linked_to": null, "options": {"showClose": true,\n"showClear": false, "showTodayButton": true, "format": "YYYY-MM-DD HH:mm:ss"}}'},domProps:{value:t.validAt},on:{input:function(e){e.target.composing||(t.validAt=e.target.value)}}}),t._m(0)])]),a("div",{staticClass:"d-flex flex-column ml-2"},[a("label",{attrs:{for:"zoom-map"}},[t._v(t._s(t.getText("Zoom:")))]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.size,expression:"size"}],staticClass:"form-control",attrs:{id:"zoom-map"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.size=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"small"}},[t._v("S")]),a("option",{attrs:{value:"regular"}},[t._v("M")]),a("option",{attrs:{value:"large"}},[t._v("L")])])]),a("div",{staticClass:"d-flex flex-column ml-2"},[a("label",{attrs:{for:"resizew"}},[t._v(t._s(t.getText("Resize the map:")))]),a("div",{staticClass:"d-flex flex-row"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.resizeW,expression:"resizeW",modifiers:{number:!0}}],staticClass:"form-control",staticStyle:{width:"5rem"},attrs:{type:"number",id:"resizew"},domProps:{value:t.resizeW},on:{input:function(e){e.target.composing||(t.resizeW=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),a("label",{attrs:{for:"resizeh"}},[t._v("×")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.resizeH,expression:"resizeH",modifiers:{number:!0}}],staticClass:"form-control",staticStyle:{width:"5rem"},attrs:{type:"number",id:"resizeh"},domProps:{value:t.resizeH},on:{input:function(e){e.target.composing||(t.resizeH=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),a("button",{staticClass:"btn btn-outline-warning ml-2",attrs:{type:"button"},on:{click:t.resizeMap}},[t._v(t._s(t.getText("Resize")))])])]),a("div",{staticClass:"vertical-divider ml-3 pl-3 d-flex align-items-center"},[a("button",{staticClass:"btn btn-lg btn-success",attrs:{type:"button"},on:{click:function(e){return t.saveChanges()}}},[a("IconBox",{attrs:{icon:"check",size:"16",text:t.getText("Save")}})],1)])])]),t.showLoading>0?a("div",{staticClass:"alert alert-secondary mt-1"},[a("IconBox",{attrs:{size:"16",icon:"hourglass-split",text:t.getText("Loading…")}})],1):t._e()],1)},Ta=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group-addon input-group-append",attrs:{"data-target":"#datetimepicker1","data-toggle":"datetimepickerv"}},[a("div",{staticClass:"input-group-text"},[a("i",{staticClass:"glyphicon glyphicon-calendar"})])])}],Ia=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.aisles=[],t.size="regular",t.validAt="",t.map=new qt(null,0,0,[]),t.resizeW=0,t.resizeH=0,t.showLoading=0,t}return Object(o["a"])(a,[{key:"mounted",value:function(){var t=this;if(this.aisles=this.appData.aisles,null===this.appData.map){for(var e=[],a=0;a<this.appData.defaultSize;a+=1)for(var i=0;i<this.appData.defaultSize;i+=1)e.push(new Wt(null,a,i,Nt.SPACE,null));this.map=new qt(null,this.appData.defaultSize,this.appData.defaultSize,e)}else this.map=qt.fromDTOs(this.appData.map,this.appData.tiles);this.resizeW=this.map.width,this.resizeH=this.map.height,this.validAt=it()().format(nt),$("#valid-at-field").on("dp.change",(function(e){t.validAt=e.date.format(nt)}))}},{key:"saveChanges",value:function(){var t=Object(pt["a"])(regeneratorRuntime.mark((function t(){var e,a,i,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.showLoading+=1,this.messages.clearMessages(),e=this.map.toMapDTO(),a=this.map.tiles.map((function(t){return ue(t,n.display.colors)})),t.prev=4,t.next=7,Xt(this.appData.saveEndpoint,e,a,this.validAt);case 7:i=t.sent,t.next=14;break;case 10:return t.prev=10,t.t0=t["catch"](4),this.messages.setError(gettext("Unable to save the map!")),t.abrupt("return");case 14:return t.prev=14,this.showLoading-=1,t.finish(14);case 17:i.success?this.messages.setSuccessFlash(i.message):i.warning?this.messages.setWarningFlash(i.message):this.messages.setError(i.message),null!==i.map&&(this.map=qt.fromDTOs(i.map,i.tiles));case 19:case"end":return t.stop()}}),t,this,[[4,10,14,17]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateColorsInLegend",value:function(){this.display.updateColors(this.aisles)}},{key:"updateRows",value:function(){this.display.updateRows()}},{key:"getRows",value:function(){return this.display.getRows()}},{key:"resizeMap",value:function(){var t=this.getRows();this.map.tiles=[];for(var e=0;e<this.resizeW;e+=1)for(var a=0;a<this.resizeH;a+=1){var i=void 0,n=void 0,s=t[a];void 0!==s&&(n=s.tiles[e]),i=void 0===n?new Wt(null,e,a,Nt.SPACE,null):new Wt(n.id,e,a,n.tileType,n.subaisle),this.map.tiles.push(i)}this.map.height=this.resizeH,this.map.width=this.resizeW,this.updateRows()}},{key:"display",get:function(){return this.$refs.display}},{key:"messages",get:function(){return this.$refs.messages}}]),a}(d["c"]);Object(u["a"])([Object(d["b"])()],Ia.prototype,"appData",void 0),Object(u["a"])([Object(d["d"])("aisles")],Ia.prototype,"updateColorsInLegend",null),Ia=Object(u["a"])([d["a"]],Ia);var Pa=Ia,La=Pa,Aa=Object(m["a"])(La,Ca,Ta,!1,null,"1d16b8ac",null),Ma=Aa.exports;i["a"].component("IconBox",f),i["a"].component("MessageDisplay",k),i["a"].component("ModalLauncher",P),i["a"].component("ModalBox",N),i["a"].component("Pagination",q),i["a"].component("TabItemDelete",Z),i["a"].component("ValidityText",ct),i["a"].component("ExtraMetadataEditorInput",Ot),i["a"].component("ProductLocationsTableRow",It),i["a"].component("MapDisplay",me),i["a"].component("MapLegend",we),i["a"].component("MapDisplayWithLegend",Te),i["a"].component("LocalPermissionTable",Be),i["a"].component("ModalItemSelector",Ke),i["a"].component("ExtraMetadataEditor",ia),i["a"].component("ProductLocationsTable",_a),i["a"].component("MapStaticDisplayApp",Sa),i["a"].component("MapEditor",Ma),i["a"].config.productionTip=!1,i["a"].mixin({methods:{getText:function(t){return gettext(t)}}}),VUE_APPS.forEach((function(t){var e;"users-edit-local-permissions"===t.THIS_APP?e=Be:"modal-item-selector"===t.THIS_APP?e=Ke:"extra-metadata-editor"===t.THIS_APP?e=ia:"product-locations-table"===t.THIS_APP?e=_a:"map-static-display"===t.THIS_APP?e=Sa:"map-editor"===t.THIS_APP&&(e=Ma),new i["a"]({el:t.APP_TAG,data:t,render:function(a){return a(e,{props:{appData:t}})}})}))}});
//# sourceMappingURL=app.js.map